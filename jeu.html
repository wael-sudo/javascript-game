<html>
<head>
</head>
<link rel="stylesheet" href="jeu.css">
<script language="javascript">
/**initialisation des variables**/
essai=0;
T=[];
for(i=1;i<8;i++)
{
	T[i]=Math.floor((Math.random() * 9) + 1);
}
corr_num=T.join("");
console.log(corr_num);

/****Validation du numero entree****/
function valide()
{
	a=document.f.numero.value;
	if (isNaN(a) || a.length!=7)
	{
		alert("entrer un numero valide (7 chiffres) le temps est ecoulee!! ");
		return false;
	}


	verifier(essai);
}
/**la verification du numero **/
function verifier(n)
{
	essai++;
	a=document.f.numero.value;
	/*for(i=1;i<8;i++)
	{*/
		switch(essai-1)
		{
			case 0:i=1
				document.f.T01.value=a[i-1];
				i++;
				document.f.T02.value=a[i-1];
				i++;
				document.f.T03.value=a[i-1];
				i++;
				document.f.T04.value=a[i-1];
				i++;
				document.f.T05.value=a[i-1];
				i++;
				document.f.T06.value=a[i-1];
				i++;
				document.f.T07.value=a[i-1];
			break;
			case 1:i=1
				document.f.T11.value=a[i-1];
				i++;
				document.f.T12.value=a[i-1];
				i++;
				document.f.T13.value=a[i-1];
				i++;
				document.f.T14.value=a[i-1];
				i++;
				document.f.T15.value=a[i-1];
				i++;
				document.f.T16.value=a[i-1];
				i++;
				document.f.T17.value=a[i-1];
			break;
			case 2:i=1
				document.f.T21.value=a[i-1];
				i++;
				document.f.T22.value=a[i-1];
				i++;
				document.f.T23.value=a[i-1];
				i++;
				document.f.T24.value=a[i-1];
				i++;
				document.f.T25.value=a[i-1];
				i++;
				document.f.T26.value=a[i-1];
				i++;
				document.f.T27.value=a[i-1];
			break;
			case 3:i=1
				document.f.T31.value=a[i-1];
				i++;
				document.f.T32.value=a[i-1];
				i++;
				document.f.T33.value=a[i-1];
				i++;
				document.f.T34.value=a[i-1];
				i++;
				document.f.T35.value=a[i-1];
				i++;
				document.f.T36.value=a[i-1];
				i++;
				document.f.T37.value=a[i-1];
			break;
			case 4:i=1
				document.f.T41.value=a[i-1];
				i++;
				document.f.T42.value=a[i-1];
				i++;
				document.f.T43.value=a[i-1];
				i++;
				document.f.T44.value=a[i-1];
				i++;
				document.f.T45.value=a[i-1];
				i++;
				document.f.T46.value=a[i-1];
				i++;
				document.f.T47.value=a[i-1];
			break;
			case 5:i=1
				document.f.T51.value=a[i-1];
				i++;
				document.f.T52.value=a[i-1];
				i++;
				document.f.T53.value=a[i-1];
				i++;
				document.f.T54.value=a[i-1];
				i++;
				document.f.T55.value=a[i-1];
				i++;
				document.f.T56.value=a[i-1];
				i++;
				document.f.T57.value=a[i-1];
			break;
			case 6:i=1
				document.f.T61.value=a[i-1];
				i++;
				document.f.T62.value=a[i-1];
				i++;
				document.f.T63.value=a[i-1];
				i++;
				document.f.T64.value=a[i-1];
				i++;
				document.f.T65.value=a[i-1];
				i++;
				document.f.T66.value=a[i-1];
				i++;
				document.f.T67.value=a[i-1];
			break; 
			case 7:i=1
				document.f.T71.value=a[i-1];
				i++;
				document.f.T72.value=a[i-1];
				i++;
				document.f.T73.value=a[i-1];
				i++;
				document.f.T74.value=a[i-1];
				i++;
				document.f.T75.value=a[i-1];
				i++;
				document.f.T76.value=a[i-1];
				i++;
				document.f.T77.value=a[i-1];
			break; 
		}
		corr_num1=corr_num;
		for (i=1;i<8;i++)
		{
			nom="T"+n+i;
			
			//if (corr_num1.indexOf(a[i-1])+1==i)
			if(corr_num1[i-1]==a[i-1])
			{
				document.getElementById(nom).style.backgroundColor="#2BADDF";
				corr_num1=corr_num1.replace(corr_num1[i-1],"*");
			}
			else if(corr_num1.indexOf(a[i-1])!=-1 && corr_num1[i-1]!=a[i-1])
			{
				document.getElementById(nom).style.backgroundColor="yellow";		
			}
			else if(corr_num1.indexOf(a[i-1])==-1)
				{
					document.getElementById(nom).style.backgroundColor="#A8ADB0";
				}
			
		}
		console.log(corr_num1);
		/*for (i=1;i<8;i++)
		{
			nom="T"+n+i;
			if(corr_num1.indexOf(a[i-1])!=-1 && corr_num1[i-1]!=a[i-1])
			{
				
				alert("ce numero est correct mais dans une pos incorrect");
				document.getElementById(nom).style.backgroundColor="yellow";
				
			}
		}*/	
			
	//}
	b=false;
	if(corr_num1=="*******")
	{ var song=new Audio();
    	song.src="win.mp3";
    	song.play();
		setInterval(function(){
			  document.getElementById("b").style.backgroundImage = "url('ttc.png')";
			  document.getElementById("b").innerHTML=""  
		},2000);
		minutes=60*1000;
		b=true;
	}
	if(essai==8)
		{
			setInterval(function(){
				  document.getElementById("b").style.backgroundImage = "url('perdu.png')"; 
			},2000);
			setInterval(function(){
				  document.getElementById("b").innerHTML="<h1 style='margin-top:500px;' class='p'>Le numero  est :</h1><center><input type='text' class='case9' value='9'><input type='text' class='case9' value='"+corr_num[0]+"'> <input type='text' class='case9' value='"+corr_num[1]+"'> <input type='text' class='case9' value='"+corr_num[2]+"'> <input type='text' class='case9' value='"+corr_num[3]+"'> <input type='text' class='case9' value='"+corr_num[4]+"'> <input type='text' class='case9' value='"+corr_num[5]+"'> <input type='text' class='case9' value='"+corr_num[6]+"'>   </center>"; 
			},2000);
		}
	document.f.numero.value="";

}
/****affichage des cases ****/
function affichage(){
aff="";
for(j=0;j<8;j++){
 	 aff+="<input type='text' class='case9' id='T"+j+"0' name='T"+j+"0' value='9' readonly> " 
for(i=1;i<8;i++){
 	aff+="<input type='text' class='case' id='T"+j+i+"' name='T"+j+i+"' value='' readonly> "
 	
}
  	 aff+="<br>"

}
 document.getElementById("x").innerHTML=aff;
}


 
//****the countdown timer****//
e=0;
c=true;
function startTimer(duration, display) {
	if(e==0){
    var timer = duration, minutes, seconds;
    setInterval(function () {
        minutes = parseInt(timer / 60, 10);
        seconds = parseInt(timer % 60, 10);

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        display.textContent = minutes + ":" + seconds;
if (minutes==1 && seconds==59 && c==true){
    	e=1;
    	var song=new Audio();
    	song.src="ticktock.mp3";
    	song.play();
    	c=false;
    }
    if (minutes==0 && seconds==11 && b==false){
    	var song=new Audio();
    	song.src="10.mp3";
    	song.play();
    }
    if(minutes==00 && seconds==00 && b==false)
    	{ 
			setInterval(function(){
				  document.getElementById("b").style.backgroundImage = "url('perdu.png')"; 
			},2000);
			setInterval(function(){
				  document.getElementById("b").innerHTML="<h1 style='margin-top:500px;' class='p'>Le numero  est :</h1><center><input type='text' class='case9' value='9'><input type='text' class='case9' value='"+corr_num[0]+"'> <input type='text' class='case9' value='"+corr_num[1]+"'> <input type='text' class='case9' value='"+corr_num[2]+"'> <input type='text' class='case9' value='"+corr_num[3]+"'> <input type='text' class='case9' value='"+corr_num[4]+"'> <input type='text' class='case9' value='"+corr_num[5]+"'> <input type='text' class='case9' value='"+corr_num[6]+"'>   </center>"; 
			},2000);
			var song=new Audio();
    		song.src="perdu.mp3";
    		song.play();
			 
    }
       if (--timer < 0) {
            timer = duration;
        }
    }, 1000);
}
}
 function timer () {
    var fiveMinutes = 60* 2,
        display = document.querySelector('#time');
    startTimer(fiveMinutes, display);
    
};






</script>

<body onload="affichage()" id="b">
<form name="f">
<p class="p">Entrer un numero du telephone (7 chiffres)</p>
<input type="text"  class="num" value="9" readonly>
<input type="text" class="numero" name="numero" onClick="timer()" maxlength="7" /><input type="button" class="btn" value="OK" onclick="valide()"><br>
<i id="x">  </i>
	

</form>
<div class="p">tick tock! <span id="time">02:00</span> minutes!</div>
</body>
</html>